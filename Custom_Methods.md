## 自定义方法

这一个章节将会讨论如何在API设计中使用自定义方法。

自定义方法指的是除了五种标准方法以外的API方法。他们只会用于那些无法轻易通过标准方法来表达的功能上。一般来说，API设计者应该在条件允许的情况下尽可能地使用标准方法。标准方法有着更简单且定义明确的语义，更为大部分开发人员所熟知，所以他们更容易被使用且更不容易出错。标准方法的另一个优势是API平台对标准方法有着更好的支持，例如错误处理、日志、监控等。

一个自定义方法可以与资源、集合或服务相关联。它可能携带任意请求、返回任意响应，也可能支持流式请求和流式响应。

自定义方法名必须遵守方法命名约定。

### 使用场合

在以下场景中使用自定义方法可能是个正确的选择：

* *重启一台虚拟机*该设计的替代方案可以是“创建一个在重启集合中的重启资源”，但感觉这样过于复杂，或者“虚拟机有一个可变状态，而客户端可以将其从RUNNING状态变为RESTARTING”，而这会带来更多的问题，例如哪些状态之间是可以互相转移的。此外，重启是一个众所周知的概念，它可以很方便地被转化成一个满足开发者期望的自定义方法。
* *发送邮件*创建一个邮件消息不一定需要发送（草稿）。跟替代方案（移动一个消息到“Outbox”集合）对比起来，自定义方法的优势在于API的使用者更容易发现并更直接地建立起概念。
* *提拔一个雇员*。如果这个功能被实现为一个标准的update，那客户端就必须重复实现企业政策中与升职流程相关的部分，来确保升职是作用在正确的等级，并且在相同的职业梯队内。
* *批量处理方法*对于性能关键的方法，提供自定义批处理方法以减少每个请求的开销可能很有用。

一些使用标准方法比自定义方法更合适的例子：
* 使用不同的查询参数来查询资源（使用标准的`list`方法与标准列表过滤）。
* 简单的资源字段更改（使用标准`update`方法与字段掩码）。
* 关闭通知（使用标准`delete`方法）。

### 通用自定义方法

如下所示是一些常用且有用的自定义方法合集。API设计人员在引入他们自己的设计前应该优先考虑使用这些名称以促进跨API的一致性
* Cancel
* POST
* 取消一个长时操作(构建、计算等等)
* BatchGet<plural noun>
* GET
* 批量获取多个资源 (在List的描述中获取更多细节)
* Move
* POST
* 将一个资源从一个父级移动到另一个
* Search
* GET
* 获取不符合列表语义的数据列表的替代方案.
* Undelete
* POST
* 还原一个先前删除的资源。推荐的保留时期为30天。
